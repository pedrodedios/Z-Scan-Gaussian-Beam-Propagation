(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47007,       1278]
NotebookOptionsPosition[     43583,       1208]
NotebookOutlinePosition[     44021,       1225]
CellTagsIndexPosition[     43978,       1222]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Z-Scan Simulation using Gaussian Beam Propagation", "Title",ExpressionUUID->"1be7ba68-9eec-494f-8db8-2fbe8a2c6641"],

Cell[CellGroupData[{

Cell["Overview", "Section",ExpressionUUID->"d6b4590b-0130-4fa0-9445-bee44bb60c18"],

Cell["\<\
This notebook simulates the Z-scan technique using Gaussian beam propagation \
and a Kerr medium.\
\>", "Text",ExpressionUUID->"66bef137-2a78-4bfe-af57-4e6b2d3866eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. Physical constants and parameters", "Section",ExpressionUUID->"2cd09828-7563-4eca-a022-392589aadea3"],

Cell["\<\
This section defines all physical, optical, and numerical parameters used in \
the Z-scan simulation.\
\>", "Text",ExpressionUUID->"632565cc-1dad-4e4b-b240-c7025c9576b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.976549504402446*^9, 3.976549504439807*^9}},
 CellLabel->
  "In[227]:=",ExpressionUUID->"700f88c8-49ce-49ab-a90f-bd8e5bad44fb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"===", "==="}], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Beam", " ", "and", " ", "laser", " ", "parameters"}], "===", 
      "==="}], "="}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", "=", 
     RowBox[{"800", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "9"}]}]}]}], " ", ";", "           ", 
    RowBox[{"(*", 
     RowBox[{"Wavelength", "[", "m", "]"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"\[Omega]0", "=", 
     RowBox[{"0.4", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "3"}]}]}]}], ";", "        ", 
    RowBox[{"(*", 
     RowBox[{"Initial", " ", "beam", " ", 
      RowBox[{"waist", "[", "m", "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"p", "=", 
     RowBox[{"100", "*", 
      RowBox[{"10", "^", "3"}]}]}], ";", "            ", 
    RowBox[{"(*", 
     RowBox[{"Laser", " ", 
      RowBox[{"power", "[", "W", "]"}]}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"===", "==="}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Optical", " ", "system", " ", "parameters"}], "===", "==="}],
        "="}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"f", "=", "0.13"}], " ", ";", "                         ", 
    RowBox[{"(*", 
     RowBox[{"Lens", " ", "focal", " ", 
      RowBox[{"length", "[", "m", "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"d", "=", 
     RowBox[{"1", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "3"}]}]}]}], ";", "                 ", 
    RowBox[{"(*", 
     RowBox[{"Kerr", " ", "medium", " ", 
      RowBox[{"thickness", "[", "m", "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"n0", "=", "1.76"}], ";", "                        ", 
    RowBox[{"(*", 
     RowBox[{"Linear", " ", "refractive", " ", "index"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"n2", "=", 
     RowBox[{"3", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "3"}]}]}]}], ";", "              ", 
    RowBox[{"(*", 
     RowBox[{"Nonlinear", " ", "refractive", " ", 
      RowBox[{"index", "[", 
       RowBox[{
        RowBox[{"m", "^", "2"}], "/", "W"}], "]"}]}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"===", "==="}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Scan", " ", "parameters"}], "===", "==="}], "="}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"z0", "=", 
     RowBox[{"-", "0.05"}]}], ";", "                     ", 
    RowBox[{"(*", 
     RowBox[{"Initial", " ", "z", " ", 
      RowBox[{"position", "[", "m", "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"zf", "=", "0.05"}], ";", "                        ", 
    RowBox[{"(*", 
     RowBox[{"Final", " ", "z", " ", 
      RowBox[{"position", "[", "m", "]"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"nSteps", "=", "200"}], ";", "                 ", 
    RowBox[{"(*", 
     RowBox[{"Number", " ", "of", " ", "scan", " ", "points"}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{"===", "==="}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Detector", " ", "parameters"}], "===", "==="}], "="}]}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Rdet", "=", 
     RowBox[{"0.5", "*", "\[Omega]0"}]}], ";"}], "           ", 
   RowBox[{"(*", 
    RowBox[{"Aperture", " ", 
     RowBox[{"radius", "[", "m", "]"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"===", "==="}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Derived", " ", "quantities"}], "===", "==="}], "="}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"I0", "[", "w_", "]"}], ":=", 
     RowBox[{"2", " ", 
      RowBox[{"p", "/", 
       RowBox[{"(", 
        RowBox[{"\[Pi]", " ", 
         RowBox[{"w", "^", "2"}]}], ")"}]}]}]}], ";", "  ", 
    RowBox[{"(*", 
     RowBox[{"Peak", " ", "intensity"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"q0", "=", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "\[Pi]", " ", 
      SuperscriptBox["\[Omega]0", "2"], " ", 
      RowBox[{"n0", "/", "\[Lambda]", "       ", 
       RowBox[{"(*", 
        RowBox[{"Initial", " ", "complex", " ", "beam", " ", "parameter"}], 
        "*)"}]}]}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.9765496827812567`*^9, 3.9765501173331013`*^9}, {
  3.976553307684206*^9, 3.976553315634746*^9}, {3.9765533504090977`*^9, 
  3.976553359250263*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"8cff26ca-11b2-4884-9e8b-bacb67349ea2"],

Cell[BoxData[
 RowBox[{"0.`", "\[VeryThinSpace]", "-", 
  RowBox[{"1.1058406140636072`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.9765508153319516`*^9, 3.9765511110513287`*^9, 
  3.976551623303596*^9, 3.976551687882657*^9, 3.976553022505638*^9, 
  3.9765533617823353`*^9, 3.9765536729335346`*^9, 3.9765597393278246`*^9},
 CellLabel->
  "Out[229]=",ExpressionUUID->"0356fc2d-1df8-4f69-bd56-60b644c0ee57"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["2. ABCD matrices", "Section",
 CellChangeTimes->{{3.97655023983956*^9, 
  3.9765502417190304`*^9}},ExpressionUUID->"9f8fa1f1-0cd8-43b5-bde5-\
045d2e0aa4ca"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FreeSpace", "[", "L_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "L"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ThinLens", "[", "f_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "1"}], "/", "f"}], ",", "1"}], "}"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Interface", "[", 
     RowBox[{"n1_", ",", "n2_"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"n1", "/", "n2"}]}], "}"}]}], "}"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KerrLens", "[", 
    RowBox[{"z_", ",", "w_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "hk2", "}"}], ",", 
     RowBox[{
      RowBox[{"hk2", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"8", "n2", " ", "p"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"n0", " ", "\[Pi]", " ", 
          RowBox[{"w", "^", "4"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "d"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "hk2"}], " ", "d"}], ",", "1"}], "}"}]}], "}"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9765502445601206`*^9, 3.976550255807361*^9}, 
   3.9765536668450537`*^9},
 CellLabel->
  "In[230]:=",ExpressionUUID->"b6de225f-52ce-4a7f-8ac7-d27bf572683b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["3. Gaussian beam propagation utilities", "Section",
 CellChangeTimes->{{3.9765503017702026`*^9, 
  3.9765503024804144`*^9}},ExpressionUUID->"7addfa37-05b3-432f-920f-\
40a19e6ac2a0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"qPropagate", "[", 
     RowBox[{"q_", ",", "M_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "q"}], "+", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"M", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "q"}], "+", 
       RowBox[{"M", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BeamWaist", "[", "q_", "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"-", "\[Lambda]"}], "/", 
     RowBox[{"(", 
      RowBox[{"\[Pi]", " ", "n0", " ", "*", 
       RowBox[{"Im", "[", 
        RowBox[{"1", "/", "q"}], "]"}]}], ")"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.976550305073575*^9, 3.976550317776149*^9}, {
   3.9765510896096764`*^9, 3.976551102586116*^9}, {3.976551554960853*^9, 
   3.9765516178628297`*^9}, {3.976551672959866*^9, 3.9765516839293623`*^9}, 
   3.976551720120779*^9, 3.9765530061739287`*^9},
 CellLabel->
  "In[234]:=",ExpressionUUID->"486410fe-befd-4eb3-8c13-af139f610f08"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4. Power through aperture", "Section",ExpressionUUID->"48980376-e383-4cd0-b2aa-ee9da4a044cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"DetectedPower", "[", "w_", "]"}], ":=", 
   RowBox[{"p", " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{
         RowBox[{"Rdet", "^", "2"}], "/", 
         RowBox[{"w", "^", "2"}]}]}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.9765503686679115`*^9, 3.976550368669882*^9}, {
  3.976550781640373*^9, 3.9765507889179974`*^9}},
 CellLabel->
  "In[236]:=",ExpressionUUID->"aec0702e-4d5e-4b67-b841-47b3cd51bcf1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["5. Test case: single thin lens", "Section",
 CellChangeTimes->{
  3.9765504029801188`*^9},ExpressionUUID->"3e1912f6-f802-4abd-8c31-\
6094fef98c26"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LensOnly", "[", "z_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"M", ",", "qf"}], "}"}], ",", 
      RowBox[{
       RowBox[{"M", "=", 
        RowBox[{
         RowBox[{"FreeSpace", "[", "z", "]"}], ".", 
         RowBox[{"ThinLens", "[", "f", "]"}], ".", 
         RowBox[{"FreeSpace", "[", "f", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"qf", "=", 
        RowBox[{"qPropagate", "[", 
         RowBox[{"q0", ",", "M"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"BeamWaist", "[", "qf", "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zVals", "=", 
   RowBox[{"Subdivide", "[", 
    RowBox[{"z0", ",", "zf", ",", "nSteps"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"waistLens", "=", 
   RowBox[{"LensOnly", "/@", "zVals"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9765504103544364`*^9, 3.976550410358564*^9}},
 CellLabel->
  "In[237]:=",ExpressionUUID->"0901fdb8-ab88-483f-9328-35c4eea821b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["6. Z-scan simulation with Kerr medium", "Section",ExpressionUUID->"4ba37ae3-fd6c-481f-8e22-a6cfb81df305"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ZScan", "[", "z_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Mpre", ",", "qIn", ",", "wIn", ",", "hk2", ",", "Mkerr", ",", "Mtot", 
        ",", "qDet", ",", "wDet"}], "}"}], ",", 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
       "*)"}], 
      RowBox[{"(*", 
       RowBox[{
       "Propagation", " ", "up", " ", "to", " ", "the", " ", "Kerr", " ", 
        "medium", " ", 
        RowBox[{"(", 
         RowBox[{"4", " ", "matrices"}], ")"}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
       "*)"}], 
      RowBox[{
       RowBox[{"Mpre", "=", 
        RowBox[{
         RowBox[{"Interface", "[", 
          RowBox[{"1", ",", "n0"}], "]"}], ".", 
         RowBox[{"FreeSpace", "[", 
          RowBox[{"L2", "[", "z", "]"}], "]"}], ".", 
         RowBox[{"ThinLens", "[", "f", "]"}], ".", 
         RowBox[{"FreeSpace", "[", "L1", "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"qIn", "=", 
        RowBox[{"qPropagate", "[", 
         RowBox[{"q0", ",", "Mpre"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"wIn", "=", 
        RowBox[{"BeamWaist", "[", "qIn", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
        "*)"}], 
       RowBox[{"(*", 
        RowBox[{
        "Kerr", " ", "parameter", " ", "evaluated", " ", "INSIDE", " ", "the",
          " ", "medium"}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
        "*)"}], 
       RowBox[{"hk2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n0", " ", "\[Pi]", " ", 
           RowBox[{"wIn", "^", "4"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"n2", " ", "p"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Mkerr", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "d"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", "1"}], "/", "hk2"}], " ", "d"}], ",", "1"}], 
           "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
        "*)"}], 
       RowBox[{"(*", 
        RowBox[{"Full", " ", "propagation", " ", "to", " ", "detector"}], 
        "*)"}], 
       RowBox[{"(*", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"--", 
                 RowBox[{"--", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "--"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], 
        "*)"}], 
       RowBox[{"Mtot", "=", 
        RowBox[{
         RowBox[{"FreeSpace", "[", "L3", "]"}], ".", 
         RowBox[{"Interface", "[", 
          RowBox[{"n0", ",", "1"}], "]"}], ".", "Mkerr", ".", "Mpre"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"qDet", "=", 
        RowBox[{"qPropagate", "[", 
         RowBox[{"q0", ",", "Mtot"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"wDet", "=", 
        RowBox[{"BeamWaist", "[", "qDet", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"wDet", ",", 
         RowBox[{"DetectedPower", "[", "wDet", "]"}]}], "}"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", "\n", "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"zData", "=", 
   RowBox[{"ZScan", "/@", "zVals"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"waistZ", "=", 
   RowBox[{"zData", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"powerZ", "=", 
   RowBox[{"zData", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.9765504547080336`*^9, 3.9765504547093267`*^9}, 
   3.9765597334049683`*^9},
 CellLabel->
  "In[240]:=",ExpressionUUID->"ac012cd8-eec1-4788-8403-be54f9b1cd1d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["7. Plots", "Section",ExpressionUUID->"484a1bf1-e65b-4660-b527-64074486e0e6"],

Cell[BoxData[
 RowBox[{"zVals", ";"}]], "Input",
 CellChangeTimes->{{3.976550914825358*^9, 3.9765509323437414`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"41e5ca2f-e0e3-4bd6-b03e-b0b43d39d37f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"waistLens", ";"}], "\[IndentingNewLine]", 
 RowBox[{"waistZ", "//", "N"}]}], "Input",
 CellChangeTimes->{{3.976550935130777*^9, 3.9765509821103525`*^9}, {
   3.976551122719967*^9, 3.9765511261984644`*^9}, {3.976551192687709*^9, 
   3.976551201856386*^9}, 3.9765530371611624`*^9, {3.9765597754492025`*^9, 
   3.976559779660475*^9}},
 CellLabel->
  "In[248]:=",ExpressionUUID->"28f3428f-3b3a-4078-837e-f6545088e3ea"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   FrameBox[GridBox[{
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"0.00038037653963109115`", " ", 
            SqrtBox[
             RowBox[{"-", 
              FractionBox["1.`", 
               RowBox[{"Im", "[", 
                FractionBox[
                 RowBox[{
                  RowBox[{"1.76`", " ", 
                   RowBox[{"(", 
                    RowBox[{"0.5681818181818182`", "\[VeryThinSpace]", "-", 
                    RowBox[{"4.370629370629371`", " ", "L1"}]}], ")"}]}], "-", 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"], "-", 
                  RowBox[{"4.561592533012378`*^12", " ", 
                   SuperscriptBox[
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], "2"], " ", 
                   RowBox[{"(", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], ")"}]}]}], 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"0.5681818181818182`", "\[VeryThinSpace]", "-", 
                    RowBox[{"4.370629370629371`", " ", "L1"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"0.001`", "\[VeryThinSpace]", "+", 
                    RowBox[{"1.76`", " ", "L3"}]}], ")"}]}], "-", 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1.`", "\[VeryThinSpace]", "-", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"]}], ")"}], " ", 
                   RowBox[{"(", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], ")"}]}]}]], "]"}]]}]]}], ",", 
           RowBox[{"0.00038037653963109115`", " ", 
            SqrtBox[
             RowBox[{"-", 
              FractionBox["1.`", 
               RowBox[{"Im", "[", 
                FractionBox[
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"], 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"]], "]"}]]}]]}], ",", 
           RowBox[{"0.00038037653963109115`", " ", 
            SqrtBox[
             RowBox[{"-", 
              FractionBox["1.`", 
               RowBox[{"Im", "[", 
                TemplateBox[{"1"},
                 "OutputSizeLimit`Skeleton"], "]"}]]}]]}], ",", 
           TemplateBox[{"195"},
            "OutputSizeLimit`Skeleton"], ",", 
           RowBox[{
            TemplateBox[{"23"},
             "OutputSizeLimit`Skeleton"], " ", 
            TemplateBox[{"1"},
             "OutputSizeLimit`Skeleton"]}], ",", 
           RowBox[{"0.00038037653963109115`", " ", 
            SqrtBox[
             RowBox[{"-", 
              FractionBox["1.`", 
               RowBox[{"Im", "[", 
                FractionBox[
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"], 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"]], "]"}]]}]]}], ",", 
           RowBox[{"0.00038037653963109115`", " ", 
            SqrtBox[
             RowBox[{"-", 
              FractionBox["1.`", 
               RowBox[{"Im", "[", 
                FractionBox[
                 RowBox[{
                  RowBox[{"1.76`", " ", 
                   RowBox[{"(", 
                    TemplateBox[{"1"},
                    "OutputSizeLimit`Skeleton"], ")"}]}], "-", 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"], "-", 
                  TemplateBox[{"1"},
                   "OutputSizeLimit`Skeleton"]}], 
                 TemplateBox[{"1"},
                  "OutputSizeLimit`Skeleton"]], "]"}]]}]]}]}], "}"}],
         Short[#, 5]& ],
        BaseStyle->{Deployed -> False},
        StripOnInput->False]},
      {GridBox[{
         {
          PaneBox[
           TagBox[
            TooltipBox[
             StyleBox[
              StyleBox[
               DynamicBox[ToBoxes[
                 FEPrivate`FrontEndResource[
                 "FEStrings", "sizeBriefExplanation"], StandardForm],
                ImageSizeCache->{54., {2., 7.}}],
               StripOnInput->False,
               DynamicUpdating->True,
               LineSpacing->{1, 2},
               LineIndent->0,
               LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLText",
              StripOnInput->False],
             StyleBox[
              DynamicBox[
               ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
                StandardForm]], DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}, StripOnInput -> False]],
            Annotation[#, 
             Style[
              Dynamic[
               FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"]], 
              DynamicUpdating -> True, LineIndent -> 0, 
              LinebreakAdjustments -> {1., 100, 0, 0, 0}, 
              LineSpacing -> {1, 2}], "Tooltip"]& ],
           Alignment->Center,
           BaselinePosition->Baseline,
           ImageSize->{Automatic, {25, Full}}], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm],
               ImageSizeCache->{64.2, {1., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 249, 27241040656246494432, 5/2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm],
               ImageSizeCache->{53.4, {1., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 249, 27241040656246494432, 5 2],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm],
               ImageSizeCache->{101.39999999999999`, {2., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           
           ButtonFunction:>OutputSizeLimit`ButtonFunction[
            OutputSizeLimit`Defer, 249, 27241040656246494432, Infinity],
           Enabled->True,
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox[
           PaneSelectorBox[{False->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm],
               ImageSizeCache->{123.60000000000001`, {1., 7.}}],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControl",
             StripOnInput->False], True->
            StyleBox[
             StyleBox[
              DynamicBox[ToBoxes[
                FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
                StandardForm]],
              StripOnInput->False,
              DynamicUpdating->True,
              LineSpacing->{1, 2},
              LineIndent->0,
              LinebreakAdjustments->{1., 100, 0, 0, 0}], "OSLControlActive",
             StripOnInput->False]}, Dynamic[
             CurrentValue["MouseOver"]],
            Alignment->Center,
            FrameMargins->0,
            ImageSize->{Automatic, {25, Full}}],
           Appearance->None,
           BaselinePosition->Baseline,
           ButtonFunction:>FrontEndExecute[{
              FrontEnd`SetOptions[
              FrontEnd`$FrontEnd, 
               FrontEnd`PreferencesSettings -> {"Page" -> "Advanced"}], 
              FrontEnd`FrontEndToken["PreferencesDialog"]}],
           Evaluator->None,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        FrameStyle->GrayLevel[0.85],
        GridBoxDividers->{"Columns" -> {False, {True}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{2}}}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxDividers->{"Columns" -> {{False}}, "Rows" -> {{False}}},
     GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{1.}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], 
         Offset[1.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    BaseStyle->"OutputSizeLimit",
    FrameMargins->{{12, 12}, {0, 15}},
    FrameStyle->GrayLevel[0.85],
    RoundingRadius->5,
    StripOnInput->False],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  If[27241040656246494432 === $SessionID, 
   Out[249], Message[
     MessageName[Syntax, "noinfoker"]]; Missing["NotAvailable"]; 
   Null]]], "Output",
 CellChangeTimes->{
  3.976553037696151*^9, {3.9765536819992895`*^9, 3.97655368335359*^9}, {
   3.97655975555042*^9, 3.9765597802293572`*^9}},
 CellLabel->
  "Out[249]=",ExpressionUUID->"844193fe-9972-4c39-88a3-11bcc6e9598e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"zVals", ",", "waistLens"}], "}"}], "]"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<z [m]\>\"", ",", "\"\<\[Omega] [m]\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<Beam waist \[Dash] thin lens\>\""}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.9765505203973103`*^9, 3.9765505455977488`*^9}, {
  3.976550901851512*^9, 3.976550902299368*^9}},
 CellLabel->
  "In[246]:=",ExpressionUUID->"b56bba0c-f215-42fe-a120-75a92b6d9054"],

Cell[BoxData[
 GraphicsBox[{{}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"z [m]\"", TraditionalForm], 
    FormBox["\"\[Omega] [m]\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"Beam waist \[Dash] thin lens\"", TraditionalForm],
  PlotRange->{{-1, 1}, {-1, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.9765505466362357`*^9, {3.9765507939886403`*^9, 3.9765508241236563`*^9}, 
   3.976550902954713*^9, 3.976551129112957*^9, 3.97655163362751*^9, 
   3.976551704366713*^9, 3.9765530322402706`*^9, 3.976553685614585*^9, 
   3.976559763400428*^9},
 CellLabel->
  "Out[246]=",ExpressionUUID->"3c53e494-99e9-4fdc-93af-8e1ab2a86a92"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"zVals", ",", "waistZ"}], "}"}], "]"}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<z [m]\>\"", ",", "\"\<\[Omega] [m]\>\""}], "}"}]}], ",", 
    RowBox[{"PlotLabel", "\[Rule]", "\"\<Beam waist \[Dash] Z-scan\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.976550531571619*^9, 3.9765505326063337`*^9}},
 CellLabel->
  "In[247]:=",ExpressionUUID->"a78566e3-8360-417f-b833-9178442af3a4"],

Cell[BoxData[
 GraphicsBox[{{}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"z [m]\"", TraditionalForm], 
    FormBox["\"\[Omega] [m]\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"Beam waist \[Dash] Z-scan\"", TraditionalForm],
  PlotRange->{{-1, 1}, {-1, 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.976550548821339*^9, 3.9765507958194*^9, 
  3.9765508260202045`*^9, 3.976551171241559*^9, 3.976551635147889*^9, 
  3.976551706414731*^9, 3.9765530339026995`*^9, 3.9765536873792014`*^9, 
  3.976559765149873*^9},
 CellLabel->
  "Out[247]=",ExpressionUUID->"f10da4d9-7691-42a4-9670-6487eeb957ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"ListLinePlot", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"zVals", ",", "powerZ"}], "}"}], "]"}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<z [m]\>\"", ",", "\"\<P [W]\>\""}], "}"}]}], ",", 
    RowBox[{
    "PlotLabel", "\[Rule]", "\"\<Detected power \[Dash] Z-scan\>\""}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.9765505419123664`*^9, 3.976550542095654*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"348636b5-d16c-4038-9610-62505b23b6fe"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
      NCache[
       Rational[1, 72], 0.013888888888888888`]], AbsoluteThickness[1.6], 
     LineBox[CompressedData["
1:eJwt0wtQ0wUcB3Ak4kh7YJDHAYfa2eLAGgZRahlcgSaSj4zDaUme6SqEXcch
t+M8SAgE5TUm2wDdg20MGU2aczz6RjqJIyJK4mmop5acCzQljcTr//ux3e22
z+1/v/s9vlu+J3PbJ95eXl4S4U2fGjW9LN8JX4tdZyrx96/Je/xT2cuSRVXY
+KR3ZNGSeZdmVkGf4Lg7N9hIvlL+RxVmD33WmaVg95iSFNjmDCu8tZXduKlX
gaY7VJBt04RVg6qN9pvJqW8bqyHZu/by5mPs4qe8lGitnzZ3J7EfvJetxMJh
g+zNhfNOu62E0Nxqe4+JHGXMOI72d6lBdsXPi2oQcLirV5fAVhXl1IC6C/Jh
2x4tVcE1E76r/JyRHB6iVCFU/PsK33y2v2+kGlnSyr9y32IPWLrV6NPRwA1k
qa9UgxXj/woTs0dCnqlFbmDL+qtytszaWYtBWt9qdlSHrA4radz7BnKXKbIe
BdSegy2LnqrHJSqXxY772HkCMdH0Yo9UlpzE0fQ//7Pc0fPzile0uG6sdS2z
sRv1DVq8IWyvJoPdlRCiQ3WQT8rTL7EfJp7Swb2VDqIjh86u1OOdUirIDtxn
16NOqPaFlO3siDfg3txgzqSIbdv1mwGbXjsSn3ZDy/eNSW1Ag3CNYQP7unSx
EXMWOvD87z/qjNh+jRpkp0ekmyARrpWNk+SbBxaZ4dccKpyc7RM/aUY7xcV5
gvvJdTSC1/8q+9JjZRYE0zit9eS8PlkTeoViwWL2FvXuU5BPilb5Ndfxfj7a
2YwI4boz4eyoy3utGOu//77QEufN/nkLSoRpBp5nu4oVX2Mtt6chj9kzbbhF
5ULZoqHnTqOW/x9qckpA92lw3Jaw28X5reDzKVTk7KUbvgGvw5/dMhRixw7O
dw1ZIp+z4wnOMzsxbeoM2rjgcfLghWkHPuW8sjPKZs4imPOpJDsyQts8eazm
fL6wox1yzh97pM/a4cmbgv8Pbeu+xdh8g+TggJ/gyVMV+YPF67qwhvPDjh54
8XtPXirJ7gMh56DhfLCHK8TnPXmoIBfGfujCLA/M1haYLyCV713OeUp69gfY
+b5l5NEpXY/nnsfIu6t39nrud5S8ryS5z3OvUs7D9sx+rOH7lJBjTdIBqPgc
R8gb3PgFD3i8YrK3NPEiUnnfRWTry/8Mwsn7/Upw3sXA6SEE8T4LySnjEaPI
4f0VkKMPYhwjvK/D5MenOyfwOu/nS8Fd5yXBV6HifeSTbZpV1/CI58+j50X7
m2545j0kOG5qgfUmcnm+XHp++dmNbsTwPHLB2vLs/bfxkPvPod9jF8TdRZjf
hHvCeVDwFfH67nv4H7Aplhs=
      "]], LineBox[CompressedData["
1:eJwt0w1M1HUYB/AbY86U2A2NDrw1DTQmNnBFnRG+jSRzgBgRHeQYokFROUdy
ITNUDHkV7ng54A7uOLg7iOSwEw6EbxeREjri5UKITA1NHFAakCRh/Z8n/tvt
9tnvt+f/+z3P978u/uN9B51EIpFc+NG/2TN7Yr0tdZtIdNMv5NIsRJ+935Gi
UpAPRGydwXZrz1FUpwnO8Dr23n1k3NuweXljuuDtAcGhU7A/c3oywnZcsKjr
a+ME5usfDIbGZ5DFVsMdqLvXWo4knqD9sVUbxyG7EZ5f9tFJqrfgIbmFkb+P
Cy88RftX+bf+AsXqcyG30jJp3QmtY5D4XfdeduI0+cf9XqOw7XZx8s36nPZ3
/PvbMKITAoWKWWSracaBeSqnOkP7/VODhqAupyeb1tMG2wfwCt8nh9YHZg70
46e+h2+O1+XS+ooLH/Yhje+XR87ZvfMqPJ2jXJ8/n0/WmsN70c73LSBLKgw9
kG+hgmfJfxW7XcYi37+Q3KwxfofQl7N3xN1hDwXEdEPL/Sgiv2Te9C2mI2xC
RXZR/dNdCOL+KMmdkV7fID/57kL9A/ZBpZ8dP3O/VORDt5uATVnuo30P2cvl
6zqRzv0rJi+Ls1zE9/rXWmYW2bMe8nZ4cD9LyLWza9qQJBSTOJeSHw3PtKKN
+8t+3D/VgieuGQ4HrSgj9zddv4B3uN/swfApK/i6YjXZafopK/4/Hlss3/EV
uJx7OdnZ9Ol5VPI82O03OpsxSe2WVpBdxU82I5Dnw94Ve8iCXKF7/c9Wkr2d
lE0Y43mxg48mnoNv7NmuOR8NeeLtrV/iGM+PLV31ViOuCNU8/bTkOIvsC6zh
ebLNr6c24IOi6fRtAVXcv6RP6nGR58vuDtOasbJRKk8IrCbf/PUHE2J43mzZ
ZhcTooTDdK/VkfeaIox4zA1hZ4xX18EodO+aga3Ic61DGOeBLUuIrMXsokNx
b4OerLG2GaDhfLD/aV5vQHAuBYCd6auuwRTnhW0rENegWEIXquHzNhTo8Srn
h+0Ic9PjNh3Pwk6eqNAhj/PEtu3y0eHFF+gxkA8PpVQv5Ystk+qrkGnvFRLE
lvgOa5fyxrbcva+BQ5h+9JZacmFvlGYpf+yRMn0lvMeoINue41aJq5xHtuX3
pAqkJNIA6rg/Ky+XQ8r5ZNt3bixH95yPMGG2bECpRjLn1cjzaBGpsfoUHZCt
SI8uQwcHjt0TP1mKBOF01h62fTi0FC6cZxPZf/9ECazaP0yX9rALYyJLIOd8
s/vtc8Wg9I72sXV5J4vRwHk3k+fHF1TYR+OIYOsGjSo84vyzJVeeU6GGrutg
q4+MKPEGfw/15DMNcUr8SeWi2YUh7kpU8OfB3vtuXRH+A5vparU=
      "]]}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"z [m]\"", TraditionalForm], 
    FormBox["\"P [W]\"", TraditionalForm]},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"Detected power \[Dash] Z-scan\"", TraditionalForm],
  PlotRange->{{-0.05, 0.05}, {-0.00001981212971458035, 0}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.02]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.976550550521019*^9, 3.9765507974060802`*^9, 
  3.9765508274905243`*^9, 3.97655166236782*^9, 3.976553688849186*^9},
 CellLabel->
  "Out[226]=",ExpressionUUID->"99cc8f90-238f-49e6-a0a2-7d4cf151151a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1152., 615.6},
WindowMargins->{{
  Automatic, -5.399999999999864}, {-5.399999999999977, Automatic}},
FrontEndVersion->"12.1 para Microsoft Windows (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"2b7b9075-e1fc-44db-bfee-93059ec18de5"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 121, 0, 97, "Title",ExpressionUUID->"1be7ba68-9eec-494f-8db8-2fbe8a2c6641"],
Cell[CellGroupData[{
Cell[726, 26, 82, 0, 67, "Section",ExpressionUUID->"d6b4590b-0130-4fa0-9445-bee44bb60c18"],
Cell[811, 28, 176, 3, 35, "Text",ExpressionUUID->"66bef137-2a78-4bfe-af57-4e6b2d3866eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1024, 36, 110, 0, 67, "Section",ExpressionUUID->"2cd09828-7563-4eca-a022-392589aadea3"],
Cell[1137, 38, 180, 3, 35, "Text",ExpressionUUID->"632565cc-1dad-4e4b-b240-c7025c9576b2"],
Cell[1320, 43, 243, 5, 74, "Input",ExpressionUUID->"700f88c8-49ce-49ab-a90f-bd8e5bad44fb"],
Cell[CellGroupData[{
Cell[1588, 52, 4779, 125, 551, "Input",ExpressionUUID->"8cff26ca-11b2-4884-9e8b-bacb67349ea2"],
Cell[6370, 179, 420, 7, 32, "Output",ExpressionUUID->"0356fc2d-1df8-4f69-bd56-60b644c0ee57"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[6839, 192, 162, 3, 67, "Section",ExpressionUUID->"9f8fa1f1-0cd8-43b5-bde5-045d2e0aa4ca"],
Cell[7004, 197, 1936, 65, 182, "Input",ExpressionUUID->"b6de225f-52ce-4a7f-8ac7-d27bf572683b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8977, 267, 187, 3, 67, "Section",ExpressionUUID->"7addfa37-05b3-432f-920f-40a19e6ac2a0"],
Cell[9167, 272, 1424, 41, 102, "Input",ExpressionUUID->"486410fe-befd-4eb3-8c13-af139f610f08"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10628, 318, 99, 0, 67, "Section",ExpressionUUID->"48980376-e383-4cd0-b2aa-ee9da4a044cb"],
Cell[10730, 320, 565, 16, 44, "Input",ExpressionUUID->"aec0702e-4d5e-4b67-b841-47b3cd51bcf1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11332, 341, 153, 3, 67, "Section",ExpressionUUID->"3e1912f6-f802-4abd-8c31-6094fef98c26"],
Cell[11488, 346, 1091, 29, 179, "Input",ExpressionUUID->"0901fdb8-ab88-483f-9328-35c4eea821b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12616, 380, 111, 0, 67, "Section",ExpressionUUID->"4ba37ae3-fd6c-481f-8e22-a6cfb81df305"],
Cell[12730, 382, 8290, 244, 428, "Input",ExpressionUUID->"ac012cd8-eec1-4788-8403-be54f9b1cd1d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21057, 631, 82, 0, 67, "Section",ExpressionUUID->"484a1bf1-e65b-4660-b527-64074486e0e6"],
Cell[21142, 633, 195, 3, 28, "Input",ExpressionUUID->"41e5ca2f-e0e3-4bd6-b03e-b0b43d39d37f"],
Cell[CellGroupData[{
Cell[21362, 640, 439, 8, 63, "Input",ExpressionUUID->"28f3428f-3b3a-4078-837e-f6545088e3ea"],
Cell[21804, 650, 12532, 318, 199, "Output",ExpressionUUID->"844193fe-9972-4c39-88a3-11bcc6e9598e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34373, 973, 592, 14, 44, "Input",ExpressionUUID->"b56bba0c-f215-42fe-a120-75a92b6d9054"],
Cell[34968, 989, 1491, 41, 250, "Output",ExpressionUUID->"3c53e494-99e9-4fdc-93af-8e1ab2a86a92"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36496, 1035, 584, 14, 63, "Input",ExpressionUUID->"a78566e3-8360-417f-b833-9178442af3a4"],
Cell[37083, 1051, 1455, 40, 250, "Output",ExpressionUUID->"f10da4d9-7691-42a4-9670-6487eeb957ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38575, 1096, 586, 15, 63, "Input",ExpressionUUID->"348636b5-d16c-4038-9610-62505b23b6fe"],
Cell[39164, 1113, 4379, 90, 254, "Output",ExpressionUUID->"99cc8f90-238f-49e6-a0a2-7d4cf151151a"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

